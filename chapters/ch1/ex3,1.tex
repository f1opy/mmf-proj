%\documentclass[a4paper, 14pt]{extreport}

%\usepackage{../../main/StyleMMF}

%\begin{document}

%\setcounter{chapter} {2}
%\chapter{Другий спосіб знаходження коефіцієнтів. Коливання стержня з вільними кінцями, неповнота базису.}

\section[Задача №3.1]{3.1}

\textit{Знайти коливання пружного стержня $0 \leq x \leq l$, лівий кінець якого закріплений, а правий вільний, якщо початкове відхилення $\varphi(x) = h \sin(3\pi x/2l)$, а початкова швидкість $\psi(x) = \nu_0 \sin(\pi x/2l)$.}

\begin{center}
    \textbf{Розв'язок}
\end{center}
Формальна постановка задачі:
\begin{equation} \label{cond3.1}
    \left\{ \begin{aligned}
        &\;u = u(x,t), \\
        &\;u_{tt} = v^2 u_{xx}, \\
        &\;0 \leq x \leq l, t \geq 0, \\
        &\;u(0,t) = 0,\\
        &\;u_x(0,t) = 0,\\
        &\left.\begin{aligned}
            &u(x,0) = \varphi(x) = h \sin \left(\frac{3 \pi x}{2 l} \right), \\ 
            &u_t(x,0) = \psi(x) = v_0 \sin \left(\frac{\pi x}{2 l}\right).
        \end{aligned}\right\} \; 
        \begin{aligned}
            &\text{ специфіка задачі} \\
          - &\text{ полягає у вигляді } \\
            &\text{ початкових умов } 
        \end{aligned}
    \end{aligned} \right.
\end{equation}

Як і задача 2.3, це задача із заданими початковими умовами, яка має єдиний розв'язок, причому рівняння і межові умови однорідні. Тому розв'язувати її можна за тим же планом, як і 2.3, а відмінність полягатиме у способі знаходження коефіцієнтів загального розв'язку.

Спочатку залишаємо у стороні початкові умови (обидві вони неоднеорідні); розділяємо змінні у рівнянні і межових умовах, які є однорідними, і знаходимо набір власних мод. Скористаємося розв'язком задачі 1.2, в якій це було зроблено:

\begin{equation}
    \left\{ \begin{aligned} \label{mode3,1}
        \;&u_n(x,t) = \left[A_n\cos(\omega_n t) + B_n\sin(\omega_n t)\right] \sin(k_n x), \\
        &k_n = (n + \frac{1}{2})\frac{\pi}{l}, \, n = 0, 1, 2,\ldots\\
        &\omega_n = vk_n = (n + \frac{1}{2})\frac{\pi v}{l} - \text{ власні частоти}.
    \end{aligned}\right.
\end{equation}

Записуємо загальний розв'язок

\begin{equation} \label{gensol3,1}
    u(x,t) = \sum^{\infty}_{n=0} \left[A_n\cos(\omega_n t) + B_n\sin(\omega_n t)\right] \sin(k_n x)
\end{equation}

\begin{equation} \label{(sol3,1)_t}
    \begin{aligned}
        u_t(x,t) &= 
   \sum^{\infty}_{n=0}\left[-A_n\omega_n\sin(\omega_n t) + B_n\omega_n\cos(\omega_n t)\right] \sin(k_n x)  
    \end{aligned}
\end{equation}

і підставляємо (\ref{gensol3,1}), (\ref{(sol3,1)_t}) у початкові умови (\ref{cond3.1}):

\begin{equation} \label{init-pos3,1}
    u(x,0) = \varphi(x) \;\Rightarrow\; \sum^{\infty}_{n=0} A_n\sin\left((n + \frac{1}{2}) \frac{\pi x}{l} \right) = h \sin \left( \frac{3 \pi x}{2l} \right)
\end{equation}

\begin{equation} \label{init-vel3,1}
    u_t(x,0) = \psi(x) \;\Rightarrow\; \sum^{\infty}_{n=0} B_n \omega_n \sin\left((n + \frac{1}{2}) \frac{\pi x}{l} \right) = v_0 \sin \left( \frac{ \pi x}{2l} \right)
\end{equation}

Із цих двох рівностей необхідно знайти коефіцієнти загального розв'язку $A_n$ і $B_n$ відповідно. Для цього у задачі (\ref{2.3}) ми одержали  формули для коефіцієтів у вигляді інтегралів, придатні для функцій $\varphi(x)$ і $\psi(x)$ загального вигляду, і потім обчислислили ці інтеграли для конкретних $\phi(x)$ i $\psi(x)$, заданих в умові задчі \ref{2.3}. За таким же зразком можна було би діяти і зараз.  Проте, уважно придивишись до рівності (\ref{init-pos3,1}), можна помітити, що функція у правій частині є однією з власних функцій задачі Штурма-Ліувіля, по яких розкладена ліва частина. Аналогічна ситуація має місце і для другої рівності (\ref{init-vel3,1}). У цьому полягає особливість цієї задачі, яка відрізняє її від задачі \ref{2.3}. Це дозволяє знайти коефіцієнти $A_n, B_n$  простіше, без обчислення інтегралів, що швидше і надійніше з точки зору імовірності зробити помилку. Обчислювати інтеграли у такій особливій ситуації не слід.


Якщо два розвинення в узагальнений ряд Фур'є по одній і тій же системі функцій рівні, то і відповідні коефіцієнти цих розвинень рівні. Це випливає з єдиності розвинення у ряд Фур'є. Скористаємося цим:

\begin{equation}
    \begin{aligned}
        \sum_{n=0} A_n \sin \left( (n + \frac{1}{2}) \frac{\pi x}{l} \right) = A_0 \sin \left(\frac{\pi x}{2 l} \right) &+\\
        + A_1 \sin \left(\frac{3 \pi x}{2 l} \right) + A_2 \sin \left(\frac{5 \pi x}{2 l} \right) + &... = h \sin \left( \frac{3 \pi x}{2 l} \right)
    \end{aligned}
\end{equation}
Прирівнюємо коефіцієнти \textit{при однакових функціях} у лівій і правій частинах. Результат має вигляд: $A_1 = h$, а всі інші коефіцієнти дорівнюють нулю $A_0 = A_2 = A_3 = ... = 0$.

Аналогічно, для рівності (\ref{init-vel3,1}): 

\begin{equation}
    \begin{aligned}
        \sum_{n=0} \omega_n B_n \sin \left( (n + \frac{1}{2}) \frac{\pi x}{l} \right) = \omega_0 B_0 \sin \left(\frac{\pi x}{2 l} \right) &+\\
        + \omega_1 B_1 \sin \left(\frac{3 \pi x}{2 l} \right) + \omega_2 B_2 \sin \left(\frac{5 \pi x}{2 l} \right) + &... = v_0 \sin \left( \frac{\pi x}{2 l} \right)
    \end{aligned}
\end{equation}
Звідси маємо: $B_0 = \frac{v_0}{\omega_0}, B_1 = B_2 = B_3 = ... = 0$.

Тепер необхідно\textit{ правильно} записати відповідь через знайдені коефіцієнти $A_n, B_n$! Підставляємо знайдені коефіцієнти у загальний розв'язок. Тільки два коефіцієнти - $A_1$ і $B_0$ не дорівнюють нулю, тож з усіх членів загального розв'язку у розв'язку задачі мають залишитись всего два!

Остаточна відповідь:

\begin{equation}
    u (x,t) = h \cos (\omega_1 t) \sin (k_1 x) + \frac{v_0}{\omega_0} \sin (\omega_0 t) \sin (k_0 x)
\end{equation}

де $k_0 = \frac{\pi x}{2 l}, k_1 = \frac{3 \pi x}{2 l}, \omega_0 = v k_0, \omega_1 = v k_1 $. Розв'язок є суперпозицією двох власних мод. Як і має бути, кожна з них має свою частоту.

Перевіримо відповідь.

\begin{itemize}
    \item Власні функції перевірені у задачі 1.2.
    \item Постановка задачі містить два неоднорідних члени у початкових умовах, один пропорційний $h$, інший пропорційний $v_0$. Розв'язок має містити доданки, пропорціні кожному з цих множників. З відповіді видно, що це дійсно так.
    \item Перевіряємо початкові умови. Переконайтесь самостійно, що вони виконуються.

\end{itemize}

Альтернативний шлях -- знайти коефіцієнти загального розв'яку як коефіцієнти розкладу у ряд Фур'є за означенням, через інтеграли. Переконаємося, що цей шлях приводить до того ж результату. Маємо:

\begin{equation}
A_n = \frac{2}{l} \int_{0}^{l} \varphi (x)  \sin \left( (\frac{1}{2} + n) \frac{\pi x}{l} \right) dx    
\end{equation}


Підставивши явний вигляд $\phi(x)$, одержимо інтеграл, який є інтегралом ортогональності власних функцій 

\begin{equation}
    \int^{l}_0 \sin \left( \frac{3 \pi x}{2 l} \right) \sin \left( \left(\frac{1}{2} + n \right) \frac{\pi x}{l} \right) dx = \int^{l}_0 X_1 (x) X_n (x) dx = \frac{l}{2}\delta_{1n}
\end{equation}

Якщо ви не побачите що інтеграл є інтегралом ортогональності, і будете його обчилювати, то втратите час і можете помилитися у викладках. У результаті одержите неправильну відповідь, що часто і відбувається.

Результат $A_1 = h, A_0 = A_2 = A_3 = ... = 0$ та для швидкостей $B_0 = \frac{v_0}{\omega_0}, B_1 = B_2 = B_3 = ... = 0$

Отримали теж саме, але складнішим шляхом!


%\end{document}