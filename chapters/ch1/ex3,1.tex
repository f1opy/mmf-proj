%\documentclass[a4paper, 14pt]{extreport}

%\usepackage{StyleMMF}

%\begin{document}

%\setcounter{chapter} {2}
%\chapter{Другий спосіб знаходження коефіцієнтів. Коливання стержня з вільними кінцями, неповнота базису.}

\section[Задача №3.1]{3.1}

\textit{Знайти коливання пружного стержня $0 \leq x \leq l$, лівий кінець якого закріплений, а правий вільний, якщо початкове відхилення $\varphi(x) = h \sin(3\pi x/2l)$, а початкова швидкість $\psi(x) = \nu_0 \sin(\pi x/2l)$.}

\begin{center}
    \textbf{Розв'язок}
\end{center}
Формальна постановка задачі:
\begin{equation} \label{cond3,1}
    \left\{ \begin{aligned} %%
        &\;u = u(x,t), \\
        &\;u_{tt} = v^2 u_{xx}, \\
        &\;0 \leq x \leq l, t \geq 0, \\
        &\;u(0,t) = 0,\\
        &\;u_x(0,t) = 0,\\
        &\left.\begin{aligned}
            &u(x,0) = \varphi(x) = h \sin \left(\frac{3 \pi x}{2 l} \right), \\ 
            &u_t(x,0) = \psi(x) = v_0 \sin \left(\frac{\pi x}{2 l}\right).
        \end{aligned}\right\} \; 
        \begin{aligned}
            &\text{ специфіка задачі} \\
          - &\text{ у вигляді } \\
            &\text{ початкових умов } 
        \end{aligned}
    \end{aligned} \right.
\end{equation}

Це задача із заданими початковими умовами (а саме - початковим розподілом зміщення та швидкостей), яка має єдиний розв'язок.

Для початку скористаємося розв'язком задачі 1.2:

\begin{equation}
    \left\{ \begin{aligned} \label{mode3.1}
        \;&u_n(x,t) = \left[A_n\cos(\omega_n t) + B_n\sin(\omega_n t)\right] \sin(k_n x), \\
        &k_n = (n + \frac{1}{2})\frac{\pi}{l}, \, n = 1, 2,\ldots\\
        &\omega_n = vk_n = (n + \frac{1}{2})\frac{\pi v}{l} - \text{ власні частоти}.
    \end{aligned}\right.
\end{equation}

І запишемо загальний розв'язок:

\begin{equation} \label{gensol3,1}
    u(x,t) = \sum^{\infty}_{n=0} \left[A_n\cos(\omega_n t) + B_n\sin(\omega_n t)\right] \sin(k_n x)
\end{equation}

\begin{equation} \label{(sol3,1)_t}
    \begin{aligned}
        u_t(x,t) &= 
   \sum^{\infty}_{n=0}\left[-A_n\omega_n\sin(\omega_n t) + B_n\omega_n\cos(\omega_n t)\right] \sin(k_n x)  
    \end{aligned}
\end{equation}

Підставляємо (\ref{gensol3,1}) у початкові умови (\ref{cond3,1}):

\begin{equation}
    u(x,0) = \varphi(x) \;\Rightarrow\; \sum^{\infty}_{n=0} A_n\sin\left((n + \frac{1}{2}) \frac{\pi x}{l} \right) = h \sin \left( \frac{3 \pi x}{2l} \right)
\end{equation}


Підставляємо (\ref{(sol3,1)_t}) у початкові умови (\ref{cond3,1}):

\begin{equation}
    u_t(x,0) = \psi(x) \;\Rightarrow\; \sum^{\infty}_{n=0} B_n \omega_n \sin\left((n + \frac{1}{2}) \frac{\pi x}{l} \right) = v_0 \sin \left( \frac{ \pi x}{2l} \right)
\end{equation}

Особливі ситуації: функції у правій частині є однією з власних функцій задачі Штурма-Ліувіля. Це дозволяє знайти коефіцієнти $A_n, B_n$ простіше, порівнюючи з загальнім знаходженням з вихідних функцій $\varphi(x)$ і  $\psi(x)$ загального вигляду! Тобто брати інтеграл у цій особливій ситуації не потрібно.


Якщо 2 ряда Фур'є по одній системі функцій рівні, то і відповідні коефіцієнти цих рядів рівні.

\begin{equation}
    \begin{aligned}
        \sum_{n=0} A_n \sin \left( (n + \frac{1}{2}) \frac{\pi x}{l} \right) = A_0 \sin \left(\frac{\pi x}{2 l} \right) &+\\
        + A_1 \sin \left(\frac{3 \pi x}{2 l} \right) + A_2 \sin \left(\frac{5 \pi x}{2 l} \right) + &... = h \sin \left( \frac{3 \pi x}{2 l} \right)
    \end{aligned}
\end{equation}

Результат $A_1 = h, A_0 = A_2 = A_3 = ... = 0$

Аналогічно робимо з \ref{(sol3,1)_t}: 

\begin{equation}
    \begin{aligned}
        \sum_{n=0} \omega_n B_n \sin \left( (n + \frac{1}{2}) \frac{\pi x}{l} \right) = \omega_0 B_0 \sin \left(\frac{\pi x}{2 l} \right) &+\\
        + \omega_1 B_1 \sin \left(\frac{3 \pi x}{2 l} \right) + \omega_2 B_2 \sin \left(\frac{5 \pi x}{2 l} \right) + &... = v_0 \sin \left( \frac{\pi x}{2 l} \right)
    \end{aligned}
\end{equation}

Результат $B_0 = \frac{v_0}{\omega_0}, B_1 = B_2 = B_3 = ... = 0$

Тепер треба правильно написати відповідь через знайдені коефіцієнти $A_n, B_n$! Підставляємо знайдені коефіцієнти у загальний розв'язок (тільки два коефіцієнти - $A_1$ і $B_0$ не дорівнюють нулю, тож членів у розв'язку всего два!)

Фінальна відповідь:

\begin{equation}
    u (x,t) = h \cos (\omega_1 t) \sin (k_1 x) + \frac{v_0}{\omega_0} \sin (\omega_0 t) \sin (k_0 x)
\end{equation}

де $k_0 = \frac{\pi x}{2 l}, k_1 = \frac{3 \pi x}{2 l}, \omega_0 = v k_0, \omega_1 = v k_1 $. Можемо помітити, що у кожної моди своя частота.

Перевіряємо відповідь

\begin{itemize}
    \item Власні функції перевірені в задачі 1.2
    \item Постановка задачі містить два неоднорідних члени у початкових умовах. Один пропорційний $\sim h$, інший пропорційний $\sim v_0$. Перевірити наявність цих множників у загальному розв'язку.
    \item Перевіряємо початкові умови - виконуються?

\end{itemize}

Альтернативний шлях -- знайти за означенням коефіцієнти розкладу у ряд Фур'є.

\begin{equation}
A_n = \frac{2}{l} \int_{0}^{l} \varphi (x)  \sin \left( (\frac{1}{2} + n) \frac{\pi x}{l} \right) dx    
\end{equation}


Одержали інтеграл ортогональності 

\begin{equation}
    \int^{l}_0 \sin \left( \frac{3 \pi x}{2 l} \right) \sin \left( (\frac{1}{2} + n) \frac{\pi x}{l} \right) dx = \int^{l}_0 \chi_1 (x) \chi_n (x) dx = \delta_{1n}
\end{equation}

Якщо ви не побачите що інтеграл є інтегралом ортогональності, і будете його обчилювати, то втратите час і можете помилитися і одержати неправильну відповідь (що часто і буває).

Результат $A_1 = h, A_0 = A_2 = A_3 = ... = 0$ та для швидкостей $B_0 = \frac{v_0}{\omega_0}, B_1 = B_2 = B_3 = ... = 0$

Отримали теж саме, але складнішим шляхом!

%\end{document}