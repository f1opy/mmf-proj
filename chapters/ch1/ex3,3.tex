%\documentclass[a4paper, 14pt]{extreport}

%\usepackage{../../main/StyleMMF}

%\begin{document}

%\setcounter{chapter}{2}

%\chapter{Другий спосіб знаходження коефіцієнтів. Коливання стержня з вільними кінцями, неповнота базису.}

\section[Задача №3.3]{3.3}

\textit{Знайти коливання пружного стержня довжиною $l$ з вільними кінцями, якщо початкове відхилення дорівнює нулю, а початкова швидкість $\psi(x) = \nu_0$. Якщо всі знайдені вами коефіцієнти Фур'є (коефіцієнти загального\\ розв’язку) дорівнюють нулю, поясніть, що це означає, і знайдіть, де була допущена помилка.}

\begin{center}
    \textbf{Розв'язок}
\end{center}
Формальна постановка задачі:
\begin{equation} \label{probcond5}
    \left\{ \begin{aligned} %%
        &\;u = u(x,t), \\
        &\;u_{tt} = v^2 u_{xx}, \\
        &\;0 \leq x \leq l, t \geq 0, \\
        &\;u_x(0,t) = u_x(0,t) = 0,\\
        &\;u(x,0) = \varphi(x) = 0, \\ 
        &\;u_t(x,0) = \psi(x) = \nu_0.
    \end{aligned} \right.
\end{equation}

Це задача із заданими початковими умовами (а саме - початковим розподілом зміщення та швидкостей), яка має єдиний розв'язок.

Рівняння і межові умови задачі однорідні, тому можна розділити змінні і знайти власні моди. Скористаємося результатом задачі 2.1 в якій  відповідні власні моди були знайдені:

\begin{equation}
    \left\{ \begin{aligned} \label{fullsol2}
        \;&u_0(x,t) = A_0 + B_0 t, \\
        &u_n(x,t) = \left[A_n\cos(\omega_n t) + B_n\sin(\omega_n t)\right] \cos(k_n x), \\
        &k_n = \frac{\pi n}{l} - \text{ хвильові вектори}, \\
        &\omega_n = vk_n = \frac{v \pi n}{l} - \text{ власні частоти}, \\
        &n = 1, 2,\ldots
    \end{aligned}\right.
\end{equation}
і запишемо загальний розв'язок:
\begin{equation} \label{gensol2}
    u(x,t) = A_0 + B_0 t + \sum^{\infty}_{n=1} \left[A_n\cos(\omega_n t) + B_n\sin(\omega_n t)\right] \cos(k_n x)
\end{equation}
та його похідну по часу:
\begin{equation} \label{dersol2}
    \begin{aligned}
        u_t(x,t) = B_0 + \sum^{\infty}_{n=1}\left[-A_n\omega_n\sin(\omega_n t) + B_n\omega_n\cos(\omega_n t)\right] \cos(k_n x)  
    \end{aligned}
\end{equation}

Як і у попередніх задачах, загальний розв'язок має вигляд  розвинення в узагальнений ряд Фур'є по власних функціях відповідної задачі Штурма-Ліувілля. Доданок загального розв'язку, який ми виділили окремо, відповідає власній функції $X_0(x)=1$ і нульовому власному значенню $\lambda_0=0$; тому відповідна власна мода (її називають нульовою модою) не є коливальною, а відповідає рівномірному рухові стержня як цілого. Саме наявність нульової моди, яка не схожа на всі інші, відрізняє дану задачу від розв'язаних раніше.
 Підставляємо (\ref{gensol2}) у початкові умови (\ref{probcond5}):

\begin{equation} \label{sol-init-pos}
    u(x,0) = \varphi(x) \;\Rightarrow\; A_0 + \sum^{\infty}_{n=1} A_n\cos k_nx = 0
\end{equation}


Підставляємо (\ref{dersol2}) у початкові умови (\ref{probcond5}):

\begin{equation} \label{sol-init-pos}
    u_t(x,0) = \psi(x) \;\Rightarrow\; B_0 + \sum^{\infty}_{n=1} B_n \omega_n \cos k_nx = \nu_0     
\end{equation}

Ліві частини одержаних рівностей є розвиненнями по ортогональній системі власних функціях задачі Штурма-Ліувілля. Прирівняємо коефіцієнти при однакових ортогональних функціях.  У результаті знаходимо  \[A_0=0;\;B_0 = \nu_0;\; A_n, B_n = 0, \text{ при } n \in \mathbb{N}\] 

Підставляємо знайдені коефіцієнти у загальний розв'язок і отримуємо розв'язок з одного доданку.

\begin{equation}
    u (x,t) = \nu_0 t 
\end{equation}

Перевіряємо відповідь

\begin{itemize}
    \item Власні функції перевірені в задачі 2.1
    \item Постановка задачі містить один неоднорідний член у початковій швидкості, пропорційний $v_0$. Перевіряємо наявністьцього множника у загальному розв'язку.
    \item Перевіряємо початкові умови - виконуються?

\item Також дана задача є прикладом, коли розв'язок можна перевірити з фізичних міркувань: стержень не має закріплених точок , у початковий момент він не деформований, і всі точки його мають однакову швидкість. Тому далі він має рівномірно рухатись як ціле. Саме такому рухові і відповідає одержаний розв'язок. 
\end{itemize}
 
 Вище ми навели правильний і найкоротший спосіб розв'язання задачі. А тепер уявімо, що ми помилилися у задачі Штурма-Ліувілля і пропустили нульове власне значення. Якими будуть наслідки? Тоді у загальному розв'язку нульової моди немає, і умова для визначення коефіцієнтів $B_n$ набуває вигляду 
\begin{equation} \label{sol-init-pos0}
    \sum^{\infty}_{n=1} B_n \omega_n \cos k_nx = \nu_0     
\end{equation}

За зразком задачі 2.3 домножаємо цю рівність на $\cos k_mx$ та інтегруємо почленно. Результатом є вираз для шуканих коефіцієнтів $B_n$ через інтеграли. Але всі вони виявляються рівними нулю
\begin{equation*}
    \begin{aligned}
        B_n =\frac{2\nu_0}{\omega_n l} \int\limits_0^l \cos(k_n x)\,\mathrm{d}x = 0 
    \end{aligned}
\end{equation*} 
Пропонуємо виконати обчислення і пересвідчитись у цьому самостійно. Отже, ми розкладали  у ряд Фур'є функцію $v_0$ (тобто константу), обчислили всі її коефіцієнти Фур'є, а сума ряду зі знайденими коефіцієнтами виявилася рівною нулю, а не $v_0$: сума ряду Фур'є не дорівнює функції, яку ми  розкладали. 
Причина цього розходження проста. Функція $v_0$, яку ми намагалися розкласти по системі $\cos k_nx$, ортогональна до всіх функцій цієї системи. Це означає, що використана нами система ортогональних функцій \textit{неповна}. Адже її можна доповнити функцією 1, ортогональною до всіх функцій системи. Рівні нулю інтеграли для коефіцієнтів $B_n$ це і є інтеграли ортогональності між 1 і всіма $\cos k_nx$. 

Цей приклад показує, до чого може призводити використання неповної системи ортогональних функцій. Повною є система \textit{всіх} власних функцій задачі Штурма-Ліувілля, а функцію $X_0=1$ ми пропустили. У результаті одержали неправильний розв'язок. Тому при розв'язанні задачі Штурма-Ліувілля так важливо ретельно перевіряти, чи \textit{всі} її власні функції знайдено.
 

%Альтернативний шлях -- знайти за означенням коефіцієнти розкладу у ряд Фур'є.

%\begin{equation}
%    A_n = \frac{2}{l} \int_{0}^{l} \varphi (x)  \sin \left( (\frac{1}{2} + n) \frac{\pi x}{l} \right) dx    
%\end{equation}

%Одержали інтеграл ортогональності 

%\begin{equation}
%    \int^{l}_0 \sin \left( \frac{3 \pi x}{2 l} \right) \sin \left( (\frac{1}{2} + n) \frac{\pi x}{l} \right) dx = \int^{l}_0 \chi_1 (x) \chi_n (x) dx = \delta_{1n}
%\end{equation}

%Якщо ви не побачите що інтеграл є інтегралом ортогональності, і будете його обчилювати, то втратите час і можете помилитися і одержати неправильну відповідь (що часто і буває).

%Результат $A_1 = h, A_0 = A_2 = A_3 = ... = 0$ та для швидкостей $B_0 = \frac{v_0}{\omega_0}, B_1 = B_2 = B_3 = ... = 0$

%Отримали теж саме, але складнішим шляхом!

%\end{document}
