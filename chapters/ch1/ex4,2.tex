%\documentclass[a4paper, 14pt]{extreport}

%\usepackage{../StyleMMF}

%\begin{document}

%\setcounter{chapter}{3}
%\chapter{Рівняння теплопровідності з однорідними межовими умовами}

\clearpage

\section[Задача №4.2]{4.2}

\textit{У початковий момент часу ліва половина стержня з теплоізольованою бічною поверхнею має температуру $T_1$ , а права -- температуру $T_2$ . Знайти розподіл температури при $t> 0$, якщо кінці стержня підтримуються при температурі $T_0$. Указівка: подумайте, що означає «температура дорівнює нулю», що це за нуль? Покладіть у кінцевому результаті $T_0 = 0$ і розгляньте частинні випадки: $T_1 = T_2$ та $T_1 = -T_2$. Які члени ряду при цьому обертаються в нуль? Чому? Нарисуйте графіки та порівняйте часову залежність температури для     різних мод. Нарисуйте (якісно) графіки розподілу     температури вдовж стержня у різні характерні послідовні моменти часу. Що таке «малий» і «великий» проміжок часу для цієї задачі? Як характерні часи залежать від розмірів системи?}

\begin{center}
    \textbf{Розв'язок}
\end{center}

\begin{wrapfigure}{r}{0.31\textwidth}
    \centering
    %Graph under comment
    \input{../graphs/4,2init-cond.tex}  % main compilation
    %\input{../../graphs/4,2init-cond.tex}  % this compilation
\end{wrapfigure}

У задачі необхідно знайти, як буде змінюватися з часом заданий початковий розподіл температури у стержні. Формулювання задачі неявно передбачає, що у межах поперечного перерізу стержня температура є однаковою. Тому тепло передається лише вздовж стержня, температура $u$ залежить лише від координати взовж стержня і часу. Процес описується одновимірним рівнянням теплопровідності; формальна постановка задачі має вигляд:
\begin{equation} \label{cond4,2}
    \left\{ \begin{aligned}
        &\;u = u(x,t), \\
        &\;u_{t} = \kappa^2 u_{xx}, \\
        &\;0 \leq x \leq l, t \geq 0, \\
        &\;u(0,t) = u(l,t) = T_0,\\
        &u(x,0) = \varphi(x) = T_1 - (T_1 - T_2)\Theta(x - l/2).
    \end{aligned} \right.
\end{equation}
\vspace{1cm}

Тут ми використали тета-функцію Хевісайта (або функцію сходинки):
\begin{equation*}
    \Theta(x - x_0) = 
    \begin{cases}
        \;0, \text{ при } x < x_0\\
        \;1, \text{ при } x > x_0
    \end{cases}    
\end{equation*}
Межові умови задачі неоднорідні, тому безпосереднє відокремлення змінних неможливе. У даному випадку можна легко привести межові умови до однорідних. Перейдемо до нової невідомоїфункції заміною\[u(x,t) = \widetilde{u}(x,t) + T_0 \]Тоді рівняння для нової невідомої функції $\widetilde{u}(x,t)$ не змінить свого вигляду. Фізично це означає, що рівняння теплопровідності  записується для різниці температур, або ж для температури, яка відраховується від довільно вибраного нуля. Якщо $u$ дорівнює температурі кінців $T_0$, то температура $\widetilde{u}$ дорівнює нулю. Отже, після заміни ми відраховуємо температуру від температури кінців.  У результаті заміни умови задачі на $\widetilde{u}$ набувають вигляду (хвильку надалі тимчасово опускаємо)
\begin{equation} \label{cond4,2 tilde}
    \left\{ \begin{aligned}
        &\;u = \widetilde{u}(x,t), \\
        &\;u_{t} = \kappa^2 u_{xx}, \\
        &\;0 \leq x \leq l, t \geq 0, \\
        &\;u(0,t) = u(l,t) = 0,\\
        &u(x,0) = \varphi(x) = T_1 - T_0 - (T_1 - T_2)\Theta(x - l/2).
    \end{aligned} \right.
\end{equation}
Тепер  рівняння і межові умови однорідні, і можена розділяти змінні. Шукаємо частинні розв'язки вигляду
\begin{equation} \label{subst4,2}
    u(x,t) = X(x)\cdot T(t) 
\end{equation}
У результаті відокремлення змінних приходимо до наступної задачі Штурма-Ліувілля на просторову частину розв'язку:
\begin{equation} 
    \left\{ \begin{aligned}
        \;&X = X(x), \\  &X'' = -\lambda X, \\ &0 \leq x \leq l, \\  &X(0) = 0, \\ &X(l) = 0. 
    \end{aligned} \right.
    \qquad\qquad
    \widetilde{T}' + \lambda D \widetilde{T} = 0
\end{equation}
Її розв'язок  (\ref{ShLsol1,1}) знайдений у задачі №1,1:
\begin{equation} 
    \left\{ \begin{aligned}
        \;&\lambda_n = \frac{\pi^2 n^2}{l^2},\\ 
        &X_n(x) = \sin\left(\frac{\pi n x}{l}\right),
    \end{aligned} \right.
    \quad \text{де } n \in \mathbb{N}.
\end{equation}

Для часової частини одержуємо лінійне рівняння першого порядку, яке ленгко розв'язується:
\begin{equation} \label{time-eq4,2}
    \begin{aligned}
        \frac{T'}{T} = -\lambda_n \kappa^2 = -\tau_n^{-1}
        \;&\Rightarrow\;
        \int \frac{\mathrm{d} T}{T} = - \int \frac{\mathrm{d} t}{\tau_n}
        \;\Rightarrow\\
        \Rightarrow\;
        \ln{T_n} = \ln{C_n} - t/\tau_n
        \;&\Rightarrow\;
        T_n = C_n e^{-t/\tau_n}, \text{ де } n \in \mathbb{N}
    \end{aligned}
\end{equation}

Виписуємо набір власних мод  системи
\begin{equation}
    \begin{aligned}
        \;&u_n(x,t) = X_n \cdot T_n = C_n e^{-t/\tau_n} \sin(k_n x),\\
        &k_n = \frac{\pi n}{l} - \text{ хвильові вектори}, \\
        &\tau_n = \frac{1}{\kappa^2 k_n^2} = \frac{l^2}{\kappa^2 \pi^2 n^2} - \text{ характерний час зміни температури}, \\
        &n = 1, 2,\ldots
    \end{aligned}
\end{equation}

Виписуємо загальний розв'язок задачі для $\widetilde{u}$ 
\begin{equation}
     \widetilde{u}(x,t) = \sum_{n=1}^{\infty}C_n e^{-t/\tau_n} \sin(k_n x)
\end{equation}

Із початкової умови на $\widetilde{u}$  (\ref{cond4,2 tilde}) одержуємо умову для визначення коефіцієнтів $C_n$:
\begin{equation}
    \sum_{n=1}^{\infty}C_n \sin(k_n x) =  T_1 - T_0 - (T_1 - T_2)\Theta(x - l/2)
\end{equation}

Оскільки права частина є функцією $x$ загального вигляду, коефіцієнти знаходимо за зразком задачі 2.3 
\begin{equation*}
    \begin{gathered}
        C_n = \frac{2}{l}\left[\int\limits_0^{l/2} (T_1 - T_0)\sin(k_n x) \;\mathrm{d}x + \int\limits_{l/2}^l (T_2 - T_0)\sin(k_n x) \;\mathrm{d}x\right] =\\
        = - \frac{2}{lk_n}\left[(T_1 - T_0)\cos(k_n x)\biggr\rvert_0^{l/2} + (T_2 - T_0)\cos(k_n x)\biggr\rvert_0^{l/2}\right] =\\
        = \frac{2}{lk_n}\left[(T_1 - T_0)(1 - \cos(k_n l/2)) + (T_2 - T_0)(\cos(k_n l/2) - (-1)^n)\right] =\\
        = \frac{2}{lk_n}\left[T_1(1 - \cos(k_n l/2)) + T_2(\cos(k_n l/2) - (-1)^n) + T_0 ((-1)^n - 1)\right]
    \end{gathered}
\end{equation*}
Для непарних і парних $n$ відповідно маємо
\begin{equation*}
    \begin{aligned}
        &n = 2m - 1: &\Rightarrow&\ C_{2m-1} = \frac{2}{k_{2m-1}l}\left[T_1 + T_2 - 2T_0 \right]\\
        &n=2m: &\Rightarrow&\ C_{2m} = \frac{2}{k_{2m}l}\left[T_1 - T_2 \right] [1 - (-1)^m]\\
       \end{aligned}    
\end{equation*}
Таким чином розв'язок для $\widetilde{u}$ природним чином розпадається на суму двох частин, які виражаються рядами окремо по непарних і парних $n$.  Перша і друга частини розв'язку пропорційна різним множникам, перша - $(T_1 + T_2 - 2T_0)$, а друга - $(T_1 - T_2)$ .  Розв'язком задачі є
\begin{equation}
    \begin{aligned}
        u(x,t) = T_0 +  
2 (T_1 + T_2 - 2T_0) \sum_{m=1}^{\infty} e^{-t/\tau_{2m-1}} \frac{\sin(k_{2m-1} x)}{l k_{2m-1}} +\\
+  
2 (T_1 - T_2) \sum_{m=1}^{\infty} [1 - (-1)^m] e^{-t/\tau_{2m}} \frac{\sin(k_{2m} x)}{l k_{2m}} 
    \end{aligned}
\end{equation}
Моди з непарними номерами є симетричними, а з парними - антисиметричними відносно середини стержня (див. задачу 1.1). Відповідно, таку ж симетрію мають суми першого і другого рядів. Такий результат обумовлений симетрією самого стержня з урахуванням фізичних умов на його кінцях. У частинному випадку $T_2 = T_1$  початковий розподіл температури є симетричним. Тоді з розв'язку видно, що його антисиметрична частина зануляється, і розподіл температури залишається симетричним відносно середини стержня в усі моменти часу. У випадку $T_2 = - T_1$ і  $T_0 = 0$ початковий розподіл температури є антисиметричним. Тоді антисиметрична частина розв'язку зануляється, і в усі моменти часу розподіл температури залишається антисиметричним відносно середини стержня . .


\begin{center}
    \textbf{Аналіз розв'язку}
\end{center}

Поведінку знайдених груп доданків можна побачити на наступному графіку. Тут наведено по одному з кожної групи. %% графік не хоче підтягуватись вгоду сторінки, бо на новій сторінці немає тексту, а на стару він не вміщається 
\begin{figure}[h]
    \centering
    %\large \textbf{Graph under comment}%
    \input{../graphs/4,2sols} %%for compiling main 
    %\input{../../graphs/4,2sols} %%for compiling this file
\caption{Перші чотири розв'язки}
\end{figure}

Проміжок часу називається малим, коли $t \ll \tau$, а великим -- $t > \tau$

%\end{document}